# Changelog

```
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⢿⣿⣷⣦⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⡿⣿⣭⢿⡧⢽⣿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣵⡟⠉⣼⡇⣾⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣶⡿⡳⠛⠁⠀⠙⢺⣯⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⢀⣀⣀⣀⣤⣤⣤⣤⣤⣠⣄⣠⣴⠟⠋⠀⠀⠀⢤⡾⠀⢘⢻⣧⣤⣠⣤⣴⣦⣶⣴⣤⣤⣤⣤⣄⣄⡀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣰⡿⠿⣟⠙⠩⢍⡉⠉⠉⠉⠉⣹⠇⠀⠀⣴⡇⣠⣾⠇⠀⠈⠿⠟⠈⢦⣄⣀⣈⣉⣉⡉⢩⣬⣽⠿⠿⢷⣄⠀⠀⠀⠀
⠀⠀⠀⠀⣴⡿⠃⠀⠉⠋⠛⠛⠉⠀⠀⠀⠀⠛⢣⣤⡿⠋⠀⠘⠏⠐⠀⢀⠀⠀⠀⠀⠉⠛⠛⣛⣛⣿⣿⠋⠀⠀⠀⠀⠹⣧⡀⠀⠀
⠀⠀⠀⣼⡏⠀⠀⠀⠀⠀⠀⠀⠀⢦⣤⣤⣠⣴⡾⠁⢀⠀⠀⠀⠀⠀⠀⠈⠻⣶⣤⠀⠀⠀⠈⠉⣹⡟⠁⠀⠀⢀⠀⠀⠀⢺⣧⠀⠀
⠀⠀⢀⣾⠇⠀⠹⠻⡟⠃⠀⠀⠀⠀⣉⣩⣉⡉⡀⢀⠀⠀⡀⠀⢀⣀⣀⠀⠀⠀⠀⣀⢀⡀⡀⢀⣿⠁⠀⢦⡿⠛⠻⣷⡀⠀⣿⡄⠀
⠀⠀⣸⣿⣤⣤⣤⣴⣦⡄⠀⠀⠀⠘⠷⢷⠲⠛⠛⠛⠻⠛⡟⠻⠻⠛⠋⠀⠀⠀⠀⠻⠛⠟⢟⣻⡿⠀⢠⡿⠃⣠⠀⠸⣧⠈⣿⡀⠀
⠀⢐⢻⡏⠉⠉⠉⠉⠉⠁⠀⠀⠀⠀⠀⠈⠀⠀⣤⣄⡀⠀⡁⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⢀⠾⣿⡇⠐⣼⠇⣰⡿⣶⠠⣿⠀⣿⡅⠀
⠀⠀⣾⡇⠀⠈⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠛⠻⠿⠿⠆⠀⠰⠟⠛⠛⠻⢛⠿⠋⢀⣿⡇⠠⣿⡄⢿⣄⣿⠀⣿⠐⣿⡆⠀
⠀⠀⣻⡷⠶⠷⢶⢦⠀⠀⠀⠈⠿⠿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠻⣶⣶⣾⣿⣇⡘⢿⡅⠘⠿⠟⢸⡟⠀⣿⡇⠀
⠀⠀⢹⣷⡄⡀⠒⠀⡀⡀⠀⠀⣀⣀⣀⣀⠀⠀⠀⠠⣄⣠⣠⡄⠀⠀⠀⠀⢶⣦⣴⣤⢶⣦⣶⣿⣿⡀⠸⣷⡀⠀⠀⣿⠃⡀⣿⡇⠀
⠀⠀⠘⠹⣿⣅⠀⠀⠙⠛⠛⠛⠛⠛⠛⠋⠀⠀⠀⠀⠈⢭⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣷⠀⠈⣷⣀⣾⠋⠰⣰⡟⠄⠀
⠀⠀⠀⠀⠻⣷⣤⣀⡀⠀⠀⠀⠀⠀⠀⠠⣀⠀⠀⠀⠀⠈⠿⠷⠶⠶⠷⠷⢤⣤⣴⣤⣤⣤⣤⠌⠛⣿⡀⠀⠈⠉⠀⢀⣼⠏⠀⠀⠀
⠀⠀⠀⠀⠀⠈⢿⣭⣉⠛⠛⠛⠛⠁⢀⠀⠛⡿⠿⢷⢷⡷⣀⠀⢀⠀⠀⡀⠀⠀⠀⡙⣿⣿⢿⣿⣿⣿⣿⣄⣀⣠⣴⡿⠁⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠈⠉⠛⠛⠛⠛⠛⠛⠛⠛⠛⠳⠒⠶⠒⠷⠚⠶⠚⠖⠳⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠉⠁⠀⠀⠀⠀⠀⠀
```

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## Versioning

Each component (Radar, PDF Generator, Deploy Tool, Web Frontend) maintains independent semantic versions:

- **MAJOR**: Breaking changes (removed CLI flags, breaking API changes, incompatible migrations)
- **MINOR**: New features, backward-compatible (new flags, new endpoints, additive migrations)
- **PATCH**: Bug fixes, backward-compatible

**Version Locations:**

- Radar: `Makefile` → `VERSION := X.Y.Z` (injected via ldflags at build time)
- PDF Generator: `tools/pdf-generator/pyproject.toml` → `version = "X.Y.Z"`
- Deploy Tool: `cmd/deploy/main.go` → `const version = "X.Y.Z"`
- Web Frontend: `web/package.json` → `"version": "X.Y.Z"`

See [Semantic Versioning 2.0.0](https://semver.org/) for detailed guidelines.

## [0.3.0] - 2025-12-01

### Radar Server

#### Added

- Transit worker for automatic sessionization of radar data into transits
  - Configurable via `--enable-transit-worker` flag (enabled by default)
  - Hourly cron-style processing with configurable interval and window
  - Manual trigger support via API endpoint
- Transit worker status tracking and health monitoring
  - New `/api/transit_worker` endpoint with GET/POST support
  - Status includes: enabled state, last run time, error info, run count, health status
- Version and git SHA logging on server startup for better debugging
- Database migration system with historical schema support
  - Migration 000001: Original schema (timestamp column, pre-JSON)
  - Migration 000002: JSON storage and write_timestamp migration
  - Migrations now properly handle legacy databases

#### Changed

- Database variable naming: `db` → `database` to avoid package shadowing
- Transit worker API responses now return full status instead of just enabled flag

#### Fixed

- Package shadowing issue where variable `db` conflicted with package name `db`
- Transit worker compatibility with old database schemas via proper migrations

### Deploy Tool

#### Added

- `--no-migrate` flag for upgrade command to skip database migrations
- Automatic database migrations during upgrade (enabled by default)
- Migrations run while service is stopped for safety

#### Changed

- Source code and Python dependency updates are now optional (skip gracefully if source not present)
- Improved error handling for binary-only installations

#### Fixed

- Upgrade warnings for missing source directory (now handled gracefully)
- Migration execution properly runs as service user with correct permissions

### Documentation

#### Added

- Database migration documentation explaining historical schema evolution
- SQL migration files cleaned up with better readability and comments

## [0.2.0] - 2025-12-01

### All Components

**Version Baseline:** This release establishes version 0.2.0 as the baseline for all components (Radar, PDF Generator, Deploy Tool, Web Frontend).

## [0.1.0] - 2025-11-30

### Radar Application

#### Added

- Version information embedded at build time via ldflags
- Git SHA tracking in binary
- Command-line version flags (`--version`, `-v`)
- `version` subcommand support
- Database migration system with schema version tracking
- Support for `--db-path` flag to specify database location
- LiDAR integration support (optional, via `--enable-lidar`)
- HTTP API endpoints for radar data and statistics
- Embedded web frontend (SvelteKit)
- Serial port multiplexing for radar sensor
- Speed unit conversion (mps, mph, kmph)
- Timezone support for timestamps

#### Changed

- Database schema version: 8
- Default database location: `sensor_data.db` (relative to working directory)

#### Fixed

- Database initialization on first run
- Serial port handling and error recovery

### PDF Generator

#### Added

- PDF report generation from radar data
- Chart generation (speed distribution, time series, etc.)
- Configurable report templates
- LaTeX-based document generation
- CLI interface with `pdf-generator` command
- Example configuration files
- Support for site information and metadata

#### Fixed

- Chart rendering with matplotlib
- Date parsing and timezone handling

### Deploy Tool

#### Added

- Installation command for local and remote hosts
- Upgrade command with automatic backup
- Rollback capability
- Status and health check commands
- SSH config support for remote deployments
- Systemd service management
- Configuration viewer and editor
- Backup and restore functionality
- Fix command for repairing broken installations

#### Configuration

- Default service user: `velocity` (dedicated system user)
- Data directory: `/var/lib/velocity-report`
- Binary location: `/usr/local/bin/velocity-report`

### Web Frontend

#### Added

- SvelteKit-based web interface
- Real-time radar data visualization
- Statistics dashboard
- API integration with Go backend
- Responsive design

---

## Links

- [GitHub Repository](https://github.com/banshee-data/velocity.report)
- [Documentation](./docs/)
- [Issue Tracker](https://github.com/banshee-data/velocity.report/issues)
- [Releases](https://github.com/banshee-data/velocity.report/releases)
